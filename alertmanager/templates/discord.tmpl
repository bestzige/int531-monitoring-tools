{{- define "discord.message" -}}
{{- if eq .Status "firing" -}}
**ALERT FIRING**
{{- else -}}
**ALERT RESOLVED**
{{- end }}

### {{- if .CommonAnnotations.title -}}
{{ .CommonAnnotations.title }}
{{- else -}}
{{ .CommonLabels.alertname }}
{{- end }}

{{- if eq .CommonLabels.severity "critical" }}
@here
{{- end }}

**Status:** {{- if eq .Status "firing" -}}FIRING{{- else -}}RESOLVED{{- end }}

**Severity:** {{- if .CommonLabels.severity -}}
{{ .CommonLabels.severity }}
{{- else -}}
unknown
{{- end }}

**Service:** {{- if .CommonLabels.service -}}
{{ .CommonLabels.service }}
{{- else -}}
N/A
{{- end }}

---

{{- range .Alerts }}
**Instance:** {{- if .Labels.instance -}}`{{ .Labels.instance }}`{{- else -}}`N/A`{{- end }}

**Details:** {{- if .Annotations.description -}}
{{ .Annotations.description }}
{{- else -}}
No description
{{- end }}

{{- if .Annotations.runbook }}
**Runbook:**  
https://github.com/bestzige/int531-monitoring-tools/tree/218/{{ .Annotations.runbook }}
{{- end }}

**{{- if eq $.Status "firing" -}}Started{{- else -}}Resolved{{- end }} at:**  
{{- if eq $.Status "firing" -}}
{{ .StartsAt.Format "2006-01-02 15:04:05" }}
{{- else -}}
{{ .EndsAt.Format "2006-01-02 15:04:05" }}
{{- end }}

---
{{- end }}

{{- if eq .Status "resolved" }}
**All alerts resolved. System is healthy.**
{{- end }}
{{- end -}}