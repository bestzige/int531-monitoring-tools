{{ define "discord.message" }}

{{ if eq .Status "firing" }}
ðŸš¨ **{{ if .CommonAnnotations.title }}{{ .CommonAnnotations.title }}{{ else }}{{ .CommonLabels.alertname }}{{ end }}**
{{ else }}
ðŸŽ‰ **{{ if .CommonAnnotations.title }}{{ .CommonAnnotations.title }}{{ else }}{{ .CommonLabels.alertname }}{{ end }}**
{{ end }}

Status: {{ if eq .Status "firing" }}ðŸ”¥ FIRING{{ else }}âœ… RESOLVED{{ end }}
Severity: {{ if .CommonLabels.severity }}{{ .CommonLabels.severity }}{{ else }}unknown{{ end }}
{{ if .CommonLabels.service }}Service: {{ .CommonLabels.service }}{{ end }}

{{ range .Alerts }}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Instance: {{ if .Labels.instance }}{{ .Labels.instance }}{{ else }}n/a{{ end }}
Description: {{ if .Annotations.description }}{{ .Annotations.description }}{{ else }}no description{{ end }}

{{ if .Annotations.runbook }}
Runbook:
https://github.com/bestzige/int531-monitoring-tools/tree/218/{{ .Annotations.runbook }}
{{ end }}

{{ if eq $.Status "firing" }}
Started: {{ .StartsAt }}
{{ else }}
Resolved: {{ .EndsAt }}
{{ end }}
{{ end }}

{{ if eq .Status "resolved" }}
ðŸ§˜ All clear. System is healthy again.
{{ end }}

{{ end }}