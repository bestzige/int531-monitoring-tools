{{- define "discord.message" -}}

{{- if eq .Status "firing" -}}
ğŸš¨ **ALERT FIRING**
{{- else -}}
âœ… **ALERT RESOLVED**
{{- end }}

---

### ğŸ”” {{- if .CommonAnnotations.title -}}
{{ .CommonAnnotations.title }}
{{- else -}}
{{ .CommonLabels.alertname }}
{{- end }}

{{- if eq .CommonLabels.severity "critical" }}
@here
{{- end }}

---

### ğŸ“Œ Summary
**Status:** `{{ if eq .Status "firing" }}FIRING{{ else }}RESOLVED{{ end }}`

**Severity:**  
{{- if .CommonLabels.severity -}}
`{{ .CommonLabels.severity }}`
{{- else -}}
`unknown`
{{- end }}

**Service:**  
{{- if .CommonLabels.service -}}
`{{ .CommonLabels.service }}`
{{- else -}}
`N/A`
{{- end }}

---

{{- range .Alerts }}

### ğŸ–¥ï¸ Instance
{{- if .Labels.instance -}}
`{{ .Labels.instance }}`
{{- else -}}
`N/A`
{{- end }}

### ğŸ“ Details
{{- if .Annotations.description }}
{{ .Annotations.description }}
{{- else }}
_No description provided_
{{- end }}

{{- if .Annotations.runbook }}

### ğŸ“˜ Runbook
ğŸ”— https://github.com/bestzige/int531-monitoring-tools/tree/main/{{ .Annotations.runbook }}

{{- end }}

### â±ï¸ {{- if eq $.Status "firing" }}Started{{ else }}Resolved{{ end }}
{{- if eq $.Status "firing" -}}
ğŸŸ¢ {{ .StartsAt.Format "2006-01-02 15:04:05" }}
{{- else -}}
ğŸŸ£ {{ .EndsAt.Format "2006-01-02 15:04:05" }}
{{- end }}

---

{{- end }}

{{- if eq .Status "resolved" }}
ğŸ‰ **All alerts resolved â€” system is healthy.**
{{- end }}

{{- end -}}