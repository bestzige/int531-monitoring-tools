{{- define "discord.message" -}}

{{- if eq .Status "firing" -}}
ğŸš¨ **ALERT FIRING**
{{- else -}}
âœ… **ALERT RESOLVED**
{{- end }}

### {{- if .CommonAnnotations.title -}}
{{ .CommonAnnotations.title }}
{{- else -}}
{{ .CommonLabels.alertname }}
{{- end }}

{{- if eq .CommonLabels.severity "critical" }}
@here
{{- end }}

---

### ğŸ“Œ Summary
â€¢ **Status:** {{- if eq .Status "firing" -}}`FIRING`{{- else -}}`RESOLVED`{{- end }}

â€¢ **Severity:** {{- if .CommonLabels.severity -}}
`{{ .CommonLabels.severity }}`
{{- else -}}
`unknown`
{{- end }}

â€¢ **Service:** {{- if .CommonLabels.service -}}
`{{ .CommonLabels.service }}`
{{- else -}}
`N/A`
{{- end }}

---

{{- range .Alerts }}

### ğŸ–¥ï¸ Instance
{{- if .Labels.instance -}}
`{{ .Labels.instance }}`
{{- else -}}
`N/A`
{{- end }}

### ğŸ“ Details
{{- if .Annotations.description -}}
{{ .Annotations.description }}
{{- else -}}
No description provided
{{- end }}

{{- if .Annotations.runbook }}
### ğŸ“– Runbook
ğŸ”— https://github.com/bestzige/int531-monitoring-tools/tree/main/{{ .Annotations.runbook }}
{{- end }}

### â±ï¸ Time
{{- if eq $.Status "firing" -}}
ğŸŸ¢ **Started:** `{{ .StartsAt.Format "2006-01-02 15:04:05" }}`
{{- else -}}
ğŸ”µ **Resolved:** `{{ .EndsAt.Format "2006-01-02 15:04:05" }}`
{{- end }}

---
{{- end }}

{{- if eq .Status "resolved" }}
ğŸŸ¢ **All alerts resolved. System is healthy.**
{{- end }}

{{- end -}}